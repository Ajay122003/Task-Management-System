{% extends 'base.html' %}
{% block content %}

<div class="container mt-3">
  <div class="row gy-4">

    <!-- Left side: Add / Edit Task -->
    <div class="col-lg-4 ">
      <div class="card shadow-sm  border-2 p-4 rounded-4">
        {% if edit_task %}
          <h4 class="fw-bold text-warning mb-3 text-center">Edit Task</h4>
          <form method="POST" action="{% url 'update_task' edit_task.id %}">
        {% else %}
          <h4 class="fw-bold text-success mb-3 text-center">Add New Task</h4>
          <form method="POST" action="{% url 'task_add' %}">
        {% endif %}
          {% csrf_token %}
          
          <div class="mb-3">
            <input type="text" name="title" class="form-control rounded-pill"
                   placeholder="Task Title" required
                   value="{{ edit_task.title|default:'' }}">
          </div>

          <div class="mb-3">
            <textarea name="description" rows="3" class="form-control rounded-3"
                      placeholder="Description">{{ edit_task.description|default:'' }}</textarea>
          </div>

          <div class="mb-3">
            <label class="form-label fw-semibold">Status</label>
            <select name="status" class="form-select rounded-pill">
              <option value="False" {% if edit_task and not edit_task.status %}selected{% endif %}>Pending</option>
              <option value="True" {% if edit_task and edit_task.status %}selected{% endif %}>Completed</option>
            </select>
          </div>
          
          {% if edit_task %}
          <button type="submit" class="btn btn-warning w-100 rounded-pill fw-semibold">
           Update Task
          </button>

           {% else %}
           <button type="submit" class="btn btn-success w-100 rounded-pill fw-semibold">
            Add Task
          </button>
          {% endif %}

          {% if edit_task %}
            <a href="{% url 'task_list' %}" class="btn btn-outline-secondary w-100 mt-2 rounded-pill">Cancel Edit</a>
          {% endif %}
        </form>
      </div>
    </div>

    <!-- Right side: Task Boxes -->
<div class="col-lg-8">
  <a href="{% url 'delete_account' %}" class="btn btn-outline-dark btn-sm">delete</a>

     <div class="d-flex justify-content-between align-items-center flex-wrap mb-3 sticky-top bg-white py-2" style="top: 0; z-index: 10;">
      <h4 class="fw-bold text-dark mb-2">My Tasks</h4>

      <!-- Filter -->
      <form method="GET" class="d-flex">
        <select name="filter" class="form-select form-select-sm rounded-pill" onchange="this.form.submit()">
          <option value="">All</option>
          <option value="pending" {% if request.GET.filter == 'pending' %}selected{% endif %}>Pending</option>
          <option value="completed" {% if request.GET.filter == 'completed' %}selected{% endif %}>Completed</option>
        </select>
      </form>
    </div>

  <div class="card border-1 shadow-sm p-4 rounded-4" style="max-height: 430px; overflow-y: auto;">

    {% if task %}
      <div class="row g-3">
        {% for t in task %}
          <div class="col-md-12">
            <div class="card border-4 shadow-sm  rounded-4 ">
              <div class="card-body">
                <h5 class="fw-bold text-dark mb-2">Title : {{ t.title }}</h5>
                <p class="text-muted small mb-3">Description : {{ t.description|default:"No description" }}</p>

                {% if t.status %}
                  <span class="badge bg-success rounded-pill px-3 py-2">Completed</span>
                {% else %}
                  <span class="badge bg-warning text-dark rounded-pill px-3 py-2">Pending</span>
                {% endif %}

                 <!-- <p className="small text-muted mt-2">
        <i className="bi bi-clock me-1"></i>
         Date : {t.created_at}
      </p>-->
              </div>

              <div class="card-footer bg-white border-0 d-flex justify-content-end">
                <a href="{% url 'update_task' t.id %}" class="btn btn-sm btn-outline-primary rounded-pill px-3">
                  <i class="bi bi-pencil-square me-1"></i>Edit
                </a>
                <a href="{% url 'delete_task' t.id %}"
                   onclick="return confirm('Are you sure you want to delete this task?');"
                   class="btn btn-sm btn-outline-danger rounded-pill px-3 ms-2">
                  <i class="bi bi-trash me-1"></i>Delete
                </a>
              </div>
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <div class="text-center py-5 text-muted">
        <i class="bi bi-clipboard-x" style="font-size:3rem;"></i>
        <p class="mt-3 fs-5 fw-semibold">No tasks found!</p>
        <p class="text-secondary">Add a new task to get started</p>
      </div>
    {% endif %}
  </div>
</div>


  </div>
</div>


<style>
.card::-webkit-scrollbar {
    width: 8px;
  }
  .card::-webkit-scrollbar-thumb {
    background-color: #ccc;
    border-radius: 10px;
  }
  .card::-webkit-scrollbar-thumb:hover {
    background-color: #999;
  }
  .transition { transition: 0.3s ease-in-out; }
  .card:hover.transition { transform: translateY(-4px); box-shadow: 0 8px 20px rgba(0,0,0,0.1); }
  textarea { resize: none; }
</style>

{% endblock %}




